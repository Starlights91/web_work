<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
			xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<meta charset="UTF-8">
<title>/templates/gallery/list.html</title>
<th:block th:insert="~{/include/resource :: bootstrap}"/>
<script src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
</head>
<body>
<th:block th:insert="~{/include/navbar :: nav('gallery')}"/>
	<div class="container">
		<a class="btn btn-outline-primary btn-sm mt-2" th:href="@{/gallery/new-form}">
	    <i class="bi bi-image"></i>
	    <i class="bi bi-plus"></i>
	    <span class="visually-hidden">갤러리 새글 작성</span>
    </a>
		<h1>Gallery 목록</h1>
		<div class="row" id="masonry-grid">
					<div th:each="tmp : ${list}" class="col-sm-6 col-md-4 col-lg-3 mb-4">
						<!--/* 여기서 th:if 는 null시 오류를 방지하기 위해 카드를 출력하지 않는 로직 */-->
						<div class="card" th:if="${tmp.imageList != null and !tmp.imageList.isEmpty()}">
							<img class="card-img-top" th:src="@{/upload/{name}(name=${tmp.imageList.get(0).saveFileName})}" />
							<div class="card-body">
								<h4>[[${tmp.title}]]</h4>
								<a class="btn btn-sm btn-success" th:href="@{/gallery/view(num=${tmp.num})}">
									[[${tmp.imageList.size()}]] 개의 이미지
								</a>
							</div>
						</div>
					</div>
		</div>
	</div>
	<script>
		// masonry 레이아웃을 초기화 하는 javascript
		const grid = document.querySelector("#masonry-grid");
		imagesLoaded(grid, ()=>{
			new Masonry(grid, { percentPosition:true});
		});
	</script>
</body>
</html>